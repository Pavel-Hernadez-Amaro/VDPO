<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to VDPO • VDPO</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to VDPO">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">VDPO</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/VDPO-01-introduction.html">Introduction to VDPO</a></li>
    <li><a class="dropdown-item" href="../articles/VDPO-02-vd-models.html">Model fitting for variable domain functional data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to VDPO</h1>
            
      

      <div class="d-none name"><code>VDPO-01-introduction.Rmd</code></div>
    </div>

    
    
<p>The VDPO R package is designed to extend statistical methods for
analyzing variable domain functional data. In traditional functional
data analysis, observations are usually defined over a common and fixed
domain, such as time or spatial coordinates. However, in some
applications, the domain over which the data are defined may vary
between observations. This type of data is referred to as variable
domain functional data.</p>
<p>The methodologies implemented in the VDPO package can be applied to a
wide range of fields like:</p>
<ul>
<li>Medical Research and Biostatistics: Analyzing time-dependent
physiological measurements or growth trajectories where the observation
periods may vary across individuals.</li>
<li>Environmental Sciences: Studying climatic or environmental patterns,
where data collected at different locations or time periods may have
variable domains.</li>
<li>Economics and Finance: Modeling financial indices or economic
indicators that may be observed over varying time horizons or under
different market conditions.</li>
</ul>
<p>The package is built upon the theoretical developments presented in
recent research papers that rigorously explore the mathematical
underpinnings and practical implications of the methodologies. More
information can be found in:</p>
<ul>
<li>Pavel Hernandez-Amaro, Maria Durban, M. Carmen Aguilera-Morillo,
Cristobal Esteban Gonzalez, Inmaculada Arostegui. “Modelling physical
activity profiles in COPD patients: a fully functional approach to
variable domain functional regression models.” doi: <a href="https://doi.org/10.48550/arXiv.2401.05839" class="external-link">10.48550/arXiv.2401.05839</a>
</li>
</ul>
<div class="section level2">
<h2 id="simulation-studies">Simulation Studies<a class="anchor" aria-label="anchor" href="#simulation-studies"></a>
</h2>
<p>The VDPO package includes a data generation function
<code><a href="../reference/data_generator_vd.html">data_generator_vd()</a></code> that allows users to simulate variable
domain functional data for testing and evaluation purposes. This section
explains how to use this function and the various scenarios it can
generate.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pavel-hernadez-amaro.github.io/VDPO/">VDPO</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-generation-function">Data Generation Function<a class="anchor" aria-label="anchor" href="#data-generation-function"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/data_generator_vd.html">data_generator_vd</a></span><span class="op">(</span></span>
<span>    N <span class="op">=</span> <span class="fl">100</span>,           <span class="co"># Number of subjects</span></span>
<span>    J <span class="op">=</span> <span class="fl">100</span>,           <span class="co"># Maximum observations per subject</span></span>
<span>    nsims <span class="op">=</span> <span class="fl">1</span>,         <span class="co"># Number of simulations</span></span>
<span>    Rsq <span class="op">=</span> <span class="fl">0.95</span>,        <span class="co"># Variance of the model</span></span>
<span>    aligned <span class="op">=</span> <span class="cn">TRUE</span>,    <span class="co"># If TRUE, generates aligned data</span></span>
<span>    multivariate <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># If TRUE, generates data with 2 variables</span></span>
<span>    beta_index <span class="op">=</span> <span class="fl">1</span>,    <span class="co"># Index for the beta function (1 or 2)</span></span>
<span>    use_x <span class="op">=</span> <span class="cn">FALSE</span>,     <span class="co"># If TRUE, adds a non-functional covariate</span></span>
<span>    use_f <span class="op">=</span> <span class="cn">FALSE</span>,     <span class="co"># If TRUE, adds a non-linear effect</span></span>
<span>    seed <span class="op">=</span> <span class="fl">42</span>          <span class="co"># Seed for reproducibility</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulation-parameters">Simulation Parameters<a class="anchor" aria-label="anchor" href="#simulation-parameters"></a>
</h3>
<div class="section level4">
<h4 id="basic-parameters">Basic Parameters<a class="anchor" aria-label="anchor" href="#basic-parameters"></a>
</h4>
<ul>
<li>
<code>N</code>: Number of subjects (default: 100)</li>
<li>
<code>J</code>: Maximum number of observations per subject (default:
100)</li>
<li>
<code>nsims</code>: Number of simulation iterations (default:
1)</li>
<li>
<code>Rsq</code>: Controls the signal-to-noise ratio (default:
0.95)</li>
</ul>
</div>
<div class="section level4">
<h4 id="domain-generation">Domain Generation<a class="anchor" aria-label="anchor" href="#domain-generation"></a>
</h4>
<p>The function can generate two types of domains:</p>
<ol style="list-style-type: decimal">
<li>
<p>Aligned domains (<code>aligned = TRUE</code>):</p>
<ul>
<li>Each subject has a different number of observations</li>
<li>Domain lengths are uniformly distributed between 10 and J</li>
<li>Domains are sorted for computational efficiency</li>
</ul>
</li>
<li>
<p>Non-aligned domains (<code>aligned = FALSE</code>):</p>
<ul>
<li>Creates gaps in the observation domain</li>
<li>Start and ending points are generated: one inside the interval [1,
J/2-5] and another in [J/2+5, J]</li>
</ul>
</li>
</ol>
<p>In both cases,</p>
</div>
</div>
<div class="section level3">
<h3 id="functional-data-generation">Functional Data Generation<a class="anchor" aria-label="anchor" href="#functional-data-generation"></a>
</h3>
<p>For each subject, the function generates:</p>
<ol style="list-style-type: decimal">
<li>A noisy functional covariate (X_se)</li>
<li>If <code>multivariate = TRUE</code>, additional variables Y_s and
Y_se are generated.</li>
</ol>
<p>The mathematical expression for generating the variable domain
functional data is the following:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mn>10</mn></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mrow><mi>i</mi><mi>k</mi><mn>1</mn></mrow></msub><mo>⋅</mo><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mn>2</mn><mi>π</mi><mi>k</mi></mrow><mn>100</mn></mfrac><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>v</mi><mrow><mi>i</mi><mi>k</mi><mn>2</mn></mrow></msub><mo>⋅</mo><mo>cos</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mn>2</mn><mi>π</mi><mi>k</mi></mrow><mn>100</mn></mfrac><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>δ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_i(t) = u_i + \sum_{k=1}^{10} \left(v_{ik1} \cdot \sin\left(\frac{2πk}{100}t\right) + v_{ik2} \cdot \cos\left(\frac{2πk}{100}t\right)\right) + δ_i(t)</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="response-generation">Response Generation<a class="anchor" aria-label="anchor" href="#response-generation"></a>
</h3>
<p>The response variable <code>y</code> is generated based on:</p>
<ol style="list-style-type: decimal">
<li>A linear functional effect (using one of two possible
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
functions)</li>
<li>Optional non-functional and non-linear covariate if
<code>use_f = TRUE</code>
</li>
<li>Optional non-functional and linear covariate if
<code>use_x = TRUE</code>
</li>
<li>Random noise based on the specified R-squared value</li>
</ol>
<p>The mathematical expression for generating the response variable is
the following:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>T</mi><mi>i</mi></msub></mfrac><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>i</mi></msub></munderover><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>≤</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">η_i = \frac{1}{T_i}\sum_{t=1}^{T_i} X_i(t)β(t, T_i), t = 1, ..., T_i ≤ J</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>
is the specific domain of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
subject.</p>
</div>
<div class="section level3">
<h3 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate basic simulation data</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_generator_vd.html">data_generator_vd</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate more complex data</span></span>
<span><span class="va">complex_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_generator_vd.html">data_generator_vd</a></span><span class="op">(</span></span>
<span>    N <span class="op">=</span> <span class="fl">200</span>, </span>
<span>    J <span class="op">=</span> <span class="fl">150</span>,</span>
<span>    aligned <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    multivariate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    use_x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    use_f <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access generated components</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>        <span class="co"># Response variable</span></span>
<span><span class="co">#&gt; [1] -0.51884279  0.77455202  0.17400721</span></span>
<span><span class="co">#&gt; [4]  0.35218196  0.35125460 -0.08737818</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">X_s</span><span class="op">)</span>       <span class="co"># Dimensions of functional covariate</span></span>
<span><span class="co">#&gt; [1] 100  99</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">x1</span><span class="op">)</span>       <span class="co"># Non-functional covariate (if use_x = TRUE)</span></span>
<span><span class="co">#&gt; [1] -1.51300593  0.23613533  0.46113917</span></span>
<span><span class="co">#&gt; [4] -0.96449987  0.87276443 -0.03593889</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="output-structure">Output Structure<a class="anchor" aria-label="anchor" href="#output-structure"></a>
</h3>
<p>The function returns a list containing:</p>
<ul>
<li>
<code>y</code>: Response variable</li>
<li>
<code>X_s</code>: Noise-free functional covariate</li>
<li>
<code>X_se</code>: Noisy functional covariate</li>
<li>
<code>Y_s</code>, <code>Y_se</code>: Additional functional variables
(if multivariate = TRUE)</li>
<li>
<code>x1</code>: Non-functional covariate</li>
<li>
<code>x2</code>: Vector of length N containing the observed values
of the smooth term</li>
<li>
<code>smooth_term</code>: vector of length N containing a smooth
term</li>
<li>
<code>Beta</code>: Array containing the true functional
coefficients</li>
</ul>
</div>
<div class="section level3">
<h3 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h3>
<ul>
<li>The function uses a fixed seed for reproducibility</li>
<li>The noise level in functional covariates is proportional to their
variance</li>
<li>Two different functional coefficient shapes are available
(controlled by <code>beta_index</code>)</li>
</ul>
<p>This data generation function allows users to create various
scenarios for testing and evaluating variable domain functional
regression models implemented in the VDPO package.</p>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-simulated-data">Visualizing Simulated Data<a class="anchor" aria-label="anchor" href="#visualizing-simulated-data"></a>
</h2>
<p>To better understand the structure of the simulated data, let’s
create some visualizations. We’ll look at both multiple functional
curves and compare an original curve with its noisy version.</p>
<div class="section level3">
<h3 id="multiple-functional-curves">Multiple Functional Curves<a class="anchor" aria-label="anchor" href="#multiple-functional-curves"></a>
</h3>
<p>First, let’s visualize multiple functional curves generated by our
simulation:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate sample data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_generator_vd.html">data_generator_vd</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>, J <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select specific rows for plotting</span></span>
<span><span class="va">selected_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">80</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare data for plotting - Multiple curves</span></span>
<span><span class="va">plot_data_multiple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">X_s</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">selected_rows</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">X_s</span><span class="op">[</span><span class="va">selected_rows</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  curve <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Subject"</span>, <span class="va">selected_rows</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">X_s</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove NA values while maintaining curve integrity</span></span>
<span><span class="va">plot_data_multiple</span> <span class="op">&lt;-</span> <span class="va">plot_data_multiple</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">curve</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>is_na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">is_na</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">is_na</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a more professional color palette</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>, <span class="st">"#009E73"</span>, <span class="st">"#E69F00"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data_multiple</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">curve</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span>, base_family <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Variable Domain Functional Data"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Selected subjects showing different domain lengths"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Subject ID"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">16</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">12</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray90"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="includes%2FVDPO-01-unnamed-chunk-3-1.png"></p>
<p>This plot shows four different functional curves generated by our
simulation. Notice how each curve has a different domain length and
pattern, reflecting the variable domain nature of our data.</p>
</div>
<div class="section level3">
<h3 id="original-vs-noisy-curve">Original vs Noisy Curve<a class="anchor" aria-label="anchor" href="#original-vs-noisy-curve"></a>
</h3>
<p>Next, let’s compare an original functional curve with its noisy
version:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot single curve with noise</span></span>
<span><span class="va">selected_curve</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">plot_data_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">X_s</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">X_s</span><span class="op">[</span><span class="va">selected_curve</span>, <span class="op">]</span>, <span class="va">sim_data</span><span class="op">$</span><span class="va">X_se</span><span class="op">[</span><span class="va">selected_curve</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="st">"Noisy"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">X_s</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data_single</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span> <span class="op">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"Noisy"</span> <span class="op">=</span> <span class="st">"#ff7f0e"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Original vs Noisy Functional Curve"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Type"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="includes%2FVDPO-01-unnamed-chunk-4-1.png"></p>
<p>This visualization shows how the added noise affects a single
functional curve. The blue line represents the original functional data
(<code>X_s</code>), while the orange line shows the same curve with
added noise (<code>X_se</code>). The noise level is proportional to the
variance of the original curve, ensuring consistent relative noise
levels across different curves.</p>
<p>These visualizations help us understand the structure and
characteristics of the simulated data, including the variable domain
lengths and the impact of added noise.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pavel Hernandez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
